---
title: "Alternative view of Human Origins factors"
author: "Peter Carbonetto"
output: workflowr::wflow_html
---

Following from [the initial analysis](hoa_global.html), this analysis
presents an alternative view of the factors.

```{r knitr-opts, include=FALSE}
knitr::opts_chunk$set(fig.align = "center")
```

## Analysis settings

This is the file with a large data frame containing the factor
loadings and other sample information.

```{r set-input-file-names}
loadings.file <- file.path("..","sandbox","loadings-forpeter-03-12-2019.rds")
```

## Set up environment

Load several R packages and function definitions used in the code
chunks below.

```{r load-pkgs, warning=FALSE, message=FALSE}
library(ggplot2)
library(ggstance)
library(cowplot)
source(file.path("..","code","hoa_global_alt_functions.R"))
```

## Load results

Load the data frame containing the factor loadings and population labels.

```{r load-results}
hoa <- load.results(loadings.file)
```

This data frame should contain information on 2,018 genotype samples:

```{r inspect-results-data-frame}
nrow(hoa)
```

## Factors 2--21

The following plots are intended to help interpret the factors by
relating them to the provided population labels.

### Factor 2

This plot shows the median loading by assigned population label, with
error bars capturing the 5th and 95th percentiles. Colours represent
broad geographic groups. Populations in which the largest loading is
less than 0.01 are not shown.

The second factor appears to capture east Asian, Oceanian and American
populations, among others.

```{r plot-factor-2, fig.width=4.5, fig.height=6}
with(hoa,plot.response.by.label(factor2,Simple.Population.ID,Region))
```

### Factor 3

```{r plot-factor-3, fig.width=4.5, fig.height=4}
with(hoa,plot.response.by.label(factor3,Simple.Population.ID,Region))
```

### Factor 4

```{r plot-factor-4, fig.width=4.5, fig.height=6}
with(hoa,plot.response.by.label(factor4,Simple.Population.ID,Region))
```

### Factor 5

```{r plot-factor-5, fig.width=4.5, fig.height=6}
with(hoa,plot.response.by.label(factor5,Simple.Population.ID,Region))
```

### Factor 6

```{r plot-factor-6, fig.width=4.5, fig.height=6}
with(hoa,plot.response.by.label(factor6,Simple.Population.ID,Region))
```

### Factor 7

```{r plot-factor-7, fig.width=4.5, fig.height=6}
with(hoa,plot.response.by.label(factor7,Simple.Population.ID,Region))
```

### Factor 8

```{r plot-factor-8, fig.width=4.5, fig.height=6}
with(hoa,plot.response.by.label(factor8,Simple.Population.ID,Region))
```

### Factor 9

```{r plot-factor-9, fig.width=4.5, fig.height=6}
with(hoa,plot.response.by.label(factor9,Simple.Population.ID,Region))
```

### Factor 10

```{r plot-factor-10, fig.width=4.5, fig.height=6}
with(hoa,plot.response.by.label(factor10,Simple.Population.ID,Region))
```
